{"version":3,"sources":["webpack://exports/webpack/bootstrap","webpack://exports/./node_modules/@skpm/events/index.js","webpack://exports/./node_modules/cocoascript-class/lib/index.js","webpack://exports/./node_modules/cocoascript-class/lib/runtime.js","webpack://exports/./node_modules/sketch-module-web-view/lib/browser-api.js","webpack://exports/./node_modules/sketch-module-web-view/lib/constants.js","webpack://exports/./node_modules/sketch-module-web-view/lib/dispatch-first-click.js","webpack://exports/./node_modules/sketch-module-web-view/lib/fitSubview.js","webpack://exports/./node_modules/sketch-module-web-view/lib/index.js","webpack://exports/./node_modules/sketch-module-web-view/lib/parseWebArguments.js","webpack://exports/./node_modules/sketch-module-web-view/lib/set-delegates.js","webpack://exports/./node_modules/sketch-module-web-view/lib/webview-api.js","webpack://exports/./node_modules/sketch-module-web-view/remote.js","webpack://exports/./src/my-command.js","webpack://exports/./src/style.js","webpack://exports/./src/unit.js","webpack://exports/external \"sketch\""],"names":["clipboard","pasteBoard","init","NSPasteboard","generalPasteboard","set","text","declareTypes_owner","NSPasteboardTypeString","setString_forType","get","stringForType","toString","onSelectionChanged","context","selection","actionContext","document","selectedLayers","layers","log","options","identifier","width","height","show","isWebviewPresent","style","getStyle","replaceCSS","replace","sendToWebview","win","BrowserWindow","loadURL","once","webContents","executeJavaScript","getRect","layer","rect","absoluteRect","x","Math","round","y","maxX","maxY","setX","setY","setWidth","setHeight","convertUnit","settings","widthUnit","heightUnit","textCSS","toFixed","convertPosition","rect1","rect2","left","top","right","bottom","positionUnit","position","getTextStyle","fontSize","lineHeight","textColor","fontSizeUnit","lineHeightUnit","rgbaCode","shadow","topShadow","shadowUnit","textShadow","color","ceil","offsetX","offsetY","blurRadius","getLayerStyle","fill","topFill","type","bg","indexOf","border","topBorder","borderUnit","thickness","boxShadow","opacity","contextSettings","colour","red","green","blue","alpha","fills","enabledFills","i","len","length","fillType","gradient","gradientStringWithMasterAlpha","borders","enabledBorders","shadows","enabledShadows","layerCount","count","getSettings","targetRect","layerClass","class","MSShapeGroup","MSRectangleShape","MSTextLayer","target","current","layerRect","Settings","sketch","Object","keys","forEach","key","value","unit","settingForKey"],"mappings":";;;;;;AAAA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,kDAA0C,gCAAgC;AAC1E;AACA;;AAEA;AACA;AACA;AACA,gEAAwD,kBAAkB;AAC1E;AACA,yDAAiD,cAAc;AAC/D;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iDAAyC,iCAAiC;AAC1E,wHAAgH,mBAAmB,EAAE;AACrI;AACA;;AAEA;AACA;AACA;AACA,mCAA2B,0BAA0B,EAAE;AACvD,yCAAiC,eAAe;AAChD;AACA;AACA;;AAEA;AACA,8DAAsD,+DAA+D;;AAErH;AACA;;;AAGA;AACA;;;;;;;;;;;;AClFA;;AAEA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA,2CAA2C;AAC3C;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,aAAa,sBAAsB;AACnC;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;;;;;;;;;;;;AC/Pa;;AAEb;AACA;AACA,CAAC;AACD;AACA;;AAEA,eAAe,mBAAO,CAAC,qEAAc;;AAErC;;AAEA;AACA;;AAEA,6EAA6E,YAAY;;AAEzF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,OAAO;AACP;AACA,KAAK;AACL;AACA;AACA;AACA,GAAG;;AAEH;AACA;;AAEA;AACA;AACA;AACA;AACA,C;;;;;;;;;;;;AC7Da;;AAEb;AACA;AACA,CAAC;AACD;AACA;AACA,kCAAkC,qCAAqC;;AAEvE;AACA;AACA,4CAA4C,sCAAsC,GAAG,YAAY;AACjG;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA,GAAG;;AAEH;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;;AAEA;AACA,iEAAiE;AACjE;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,oBAAoB,QAAQ,YAAY,WAAW;AACnD;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;;AAEA;AACA,8GAA8G,YAAY,GAAG,YAAY,GAAG,aAAa,IAAI,UAAU,WAAW,GAAG;AACrL;AACA,8GAA8G,YAAY,GAAG,YAAY,GAAG,YAAY,IAAI,UAAU,WAAW,GAAG;;AAEpL;AACA,wCAAwC,gCAAgC,E;;;;;;;;;;;ACvGxE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,mBAAmB,OAAO;AAC1B;AACA;AACA;AACA,GAAG;AACH;AACA,GAAG;AACH;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA,qBAAqB;AACrB;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA,qBAAqB;AACrB;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,OAAO;AACP;AACA,OAAO;AACP;AACA,OAAO;AACP;AACA,OAAO;AACP;AACA,OAAO;AACP;AACA,OAAO;AACP;AACA,OAAO;AACP;AACA;AACA,OAAO;AACP;AACA;AACA;;AAEA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA,KAAK;AACL;AACA,KAAK;AACL;AACA,KAAK;AACL;AACA,KAAK;AACL;AACA,KAAK;AACL;AACA,KAAK;AACL;AACA,KAAK;AACL;AACA,KAAK;AACL;AACA,KAAK;AACL;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;;;;;;;;;;;AC3jBA;AACA;AACA;;;;;;;;;;;;ACFA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA,QAAQ;AACR,gBAAgB;AAChB,MAAM,eAAe;AACrB,0CAA0C,cAAc;AACxD,MAAM;AACN;AACA;;;;;;;;;;;;ACvBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;;;;;;;;;;;ACrBA;AACA;AACA,mBAAmB,mBAAO,CAAC,0DAAc;AACzC,sBAAsB,mBAAO,CAAC,+EAAe;AAC7C,kBAAkB,mBAAO,CAAC,+EAAe;AACzC,uBAAuB,mBAAO,CAAC,6EAAc;AAC7C,yBAAyB,mBAAO,CAAC,iGAAwB;AACzD,mBAAmB,mBAAO,CAAC,mFAAiB;;AAE5C;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,GAAG;;AAEH;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;;;;;;;;;;;;AC5SA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;;;;;;;;;;;AClBA,gBAAgB,mBAAO,CAAC,wEAAmB;AAC3C,wBAAwB,mBAAO,CAAC,2FAAqB;AACrD,gBAAgB,mBAAO,CAAC,2EAAa;;AAErC;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,OAAO;;AAEP;AACA;AACA;AACA,OAAO;;AAEP;AACA;AACA;AACA,OAAO;;AAEP;AACA;AACA;AACA,OAAO;;AAEP;AACA;AACA;AACA,OAAO;;AAEP;AACA;AACA;AACA;AACA,OAAO;;AAEP;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA,WAAW;AACX,SAAS;AACT;AACA,OAAO;;AAEP;AACA;AACA,OAAO;;AAEP;AACA;AACA,OAAO;;AAEP;AACA;AACA,OAAO;AACP,KAAK;AACL;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;;AAEA;AACA;AACA;AACA;AACA,aAAa;;AAEb;AACA;AACA;AACA,YAAY;AACZ;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;;AAEP;AACA;AACA;AACA;AACA;AACA,aAAa;;AAEb;AACA,0EAA0E;;AAE1E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;;AAEP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,OAAO;;AAEP;AACA;AACA;AACA,OAAO;;AAEP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;;AAEP;AACA;AACA;AACA,OAAO;;AAEP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA,aAAa;AACb,WAAW;AACX;AACA;;AAEA;AACA;AACA;AACA,OAAO;;AAEP;AACA;AACA;AACA,OAAO;;AAEP;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,2CAA2C;AAC3C,OAAO;AACP,KAAK;AACL;;AAEA;AACA;AACA;AACA;AACA;AAC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","file":"my-command.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./src/my-command.js\");\n","function EventEmitter () {}\n\n// By default, a maximum of 10 listeners can be registered for any single event.\nEventEmitter.defaultMaxListeners = 10\n\n// Shortcuts to improve speed and size\nvar proto = EventEmitter.prototype\n\nproto._maxListeners = EventEmitter.defaultMaxListeners\n\nfunction indexOfListener (listeners, listener) {\n  var i = listeners.length\n  while (i--) {\n    if (listeners[i].listener === listener) {\n      return i\n    }\n  }\n\n  return -1\n}\n\nfunction alias (name) {\n  return function aliasClosure () {\n    return this[name].apply(this, arguments)\n  }\n}\n\nfunction isValidListener (listener) {\n  if (typeof listener === 'function') {\n    return true\n  } else if (listener && typeof listener === 'object') {\n    return isValidListener(listener.listener)\n  } else {\n    return false\n  }\n}\n\nproto._getListeners = function _getListeners (evt) {\n  var events = this._getEvents()\n\n  return events[evt] || (events[evt] = [])\n}\n\nproto._getEvents = function _getEvents () {\n  return this._events || (this._events = {})\n}\n\n/*\n  Alias for emitter.on(eventName, listener).\n*/\nproto.addListener = alias('on')\n\n/*\n  Synchronously calls each of the listeners registered for the event named eventName, in the order they were registered, passing the supplied arguments to each.\n\n  Returns true if the event had listeners, false otherwise.\n*/\nproto.emit = function emit (evt) {\n  var args = Array.prototype.slice.call(arguments, 1)\n  var listeners = this._getListeners(evt) || []\n  var listener\n  var i\n  var key\n  var response\n\n  for (i = 0; i < listeners.length; i++) {\n    listener = listeners[i]\n\n    if (listener.once === true) {\n      this.removeListener(evt, listener.listener)\n    }\n\n    response = listener.listener.apply(this, args || [])\n  }\n\n  return listeners.length > 0\n}\n\n/*\n  Returns an array listing the events for which the emitter has registered listeners.\n  The values in the array will be strings or Symbols.\n*/\nproto.eventNames = function eventNames () {\n  var events = this._getEvents()\n  return Object.keys(events)\n}\n\n/*\n  Returns the current max listener value for the EventEmitter which is either set by emitter.setMaxListeners(n) or defaults to EventEmitter.defaultMaxListeners.\n*/\nproto.getMaxListeners = function getMaxListeners() {\n  return this._maxListeners\n}\n\n/*\n  Returns the number of listeners listening to the event named eventName.\n*/\nproto.listenerCount = function listenerCount(eventName) {\n  return this._getListeners(eventName).length\n}\n\n/*\n  Returns a copy of the array of listeners for the event named eventName.\n*/\nproto.listeners = function listeners(eventName) {\n  return this._getListeners(eventName).map(function (wrappedListener) {\n    return wrappedListener.listener\n  })\n}\n\n/*\n  Adds the listener function to the end of the listeners array for the event named eventName. No checks are made to see if the listener has already been added. Multiple calls passing the same combination of eventName and listener will result in the listener being added, and called, multiple times.\n\n  Returns a reference to the EventEmitter, so that calls can be chained.\n\n  By default, event listeners are invoked in the order they are added. The emitter.prependListener() method can be used as an alternative to add the event listener to the beginning of the listeners array.\n*/\nproto.on = function on (evt, listener) {\n  if (!isValidListener(listener)) {\n    throw new Error('listener must be a function')\n  }\n\n  var listeners = this._getListeners(evt)\n  var listenerIsWrapped = typeof listener === 'object'\n\n  this.emit('newListener', evt, listenerIsWrapped ? listener.listener : listener)\n\n  listeners.push(\n    listenerIsWrapped\n    ? listener\n    : {\n      listener: listener,\n      once: false\n    }\n  )\n\n  return this\n}\n\n/*\n  Adds a one-time listener function for the event named eventName. The next time eventName is triggered, this listener is removed and then invoked.\n\n  Returns a reference to the EventEmitter, so that calls can be chained.\n\n  By default, event listeners are invoked in the order they are added. The emitter.prependOnceListener() method can be used as an alternative to add the event listener to the beginning of the listeners array.\n*/\nproto.once = function once (evt, listener) {\n  return this.on(evt, {\n    listener: listener,\n    once: true\n  })\n}\n\n/*\n  Adds the listener function to the beginning of the listeners array for the event named eventName. No checks are made to see if the listener has already been added. Multiple calls passing the same combination of eventName and listener will result in the listener being added, and called, multiple times.\n\n  Returns a reference to the EventEmitter, so that calls can be chained.\n*/\nproto.prependListener = function prependListener (evt, listener) {\n  if (!isValidListener(listener)) {\n    throw new Error('listener must be a function')\n  }\n\n  var listeners = this._getListeners(evt)\n  var listenerIsWrapped = typeof listener === 'object'\n\n  this.emit('newListener', evt, listenerIsWrapped ? listener.listener : listener)\n\n  listeners.unshift(\n    listenerIsWrapped\n    ? listener\n    : {\n      listener: listener,\n      once: false\n    }\n  )\n\n  return this\n}\n\n/*\n  Adds a one-time listener function for the event named eventName to the beginning of the listeners array. The next time eventName is triggered, this listener is removed, and then invoked.\n\n  Returns a reference to the EventEmitter, so that calls can be chained.\n*/\nproto.prependOnceListener = function prependOnceListener (evt, listener) {\n  return this.prependListener(evt, {\n    listener: listener,\n    once: true\n  })\n}\n\n/*\n  Removes all listeners, or those of the specified eventName.\n\n  Note that it is bad practice to remove listeners added elsewhere in the code, particularly when the EventEmitter instance was created by some other component or module (e.g. sockets or file streams).\n\n  Returns a reference to the EventEmitter, so that calls can be chained.\n*/\nproto.removeAllListeners = function removeAllListeners (evt) {\n  var events = this._getEvents()\n\n  if (typeof evt === 'string') {\n    // Remove all listeners for the specified event\n    delete events[evt]\n  } else {\n    // Remove all listeners in all events\n    delete this._events\n  }\n\n  return this\n}\n\n/*\n  Removes the specified listener from the listener array for the event named eventName.\n\n  removeListener will remove, at most, one instance of a listener from the listener array. If any single listener has been added multiple times to the listener array for the specified eventName, then removeListener must be called multiple times to remove each instance.\n\n  Note that once an event has been emitted, all listeners attached to it at the time of emitting will be called in order. This implies that any removeListener() or removeAllListeners() calls after emitting and before the last listener finishes execution will not remove them from emit() in progress. Subsequent events will behave as expected.\n\n  Because listeners are managed using an internal array, calling this will change the position indices of any listener registered after the listener being removed. This will not impact the order in which listeners are called, but it means that any copies of the listener array as returned by the emitter.listeners() method will need to be recreated.\n\n  Returns a reference to the EventEmitter, so that calls can be chained.\n*/\nproto.removeListener = function removeListener (evt, listener) {\n  var listeners = this._getListeners(evt)\n\n  var index = indexOfListener(listeners, listener)\n\n  if (index !== -1) {\n    listeners.splice(index, 1)\n\n    this.emit('removeListener', evt, listener)\n  }\n\n  return this\n}\n\n/*\n  By default EventEmitters will print a warning if more than 10 listeners are added for a particular event. This is a useful default that helps finding memory leaks. Obviously, not all events should be limited to just 10 listeners. The emitter.setMaxListeners() method allows the limit to be modified for this specific EventEmitter instance. The value can be set to Infinity (or 0) to indicate an unlimited number of listeners.\n\n  Returns a reference to the EventEmitter, so that calls can be chained.\n*/\nproto.setMaxListeners = function setMaxListeners (n) {\n  this._maxListeners = n\n  return this\n}\n\n/*\n  Returns a copy of the array of listeners for the event named eventName, including any wrappers (such as those created by .once).\n*/\nproto.rawListeners = function rawListeners (evt) {\n  return this._getListeners(evt).slice()\n}\n\nmodule.exports = EventEmitter\n","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.SuperCall = undefined;\nexports.default = ObjCClass;\n\nvar _runtime = require(\"./runtime.js\");\n\nexports.SuperCall = _runtime.SuperCall;\n\n// super when returnType is id and args are void\n// id objc_msgSendSuper(struct objc_super *super, SEL op, void)\n\nconst SuperInit = (0, _runtime.SuperCall)(NSStringFromSelector(\"init\"), [], { type: \"@\" });\n\n// Returns a real ObjC class. No need to use new.\nfunction ObjCClass(defn) {\n  const superclass = defn.superclass || NSObject;\n  const className = (defn.className || defn.classname || \"ObjCClass\") + NSUUID.UUID().UUIDString();\n  const reserved = new Set(['className', 'classname', 'superclass']);\n  var cls = MOClassDescription.allocateDescriptionForClassWithName_superclass_(className, superclass);\n  // Add each handler to the class description\n  const ivars = [];\n  for (var key in defn) {\n    const v = defn[key];\n    if (typeof v == 'function' && key !== 'init') {\n      var selector = NSSelectorFromString(key);\n      cls.addInstanceMethodWithSelector_function_(selector, v);\n    } else if (!reserved.has(key)) {\n      ivars.push(key);\n      cls.addInstanceVariableWithName_typeEncoding(key, \"@\");\n    }\n  }\n\n  cls.addInstanceMethodWithSelector_function_(NSSelectorFromString('init'), function () {\n    const self = SuperInit.call(this);\n    ivars.map(name => {\n      Object.defineProperty(self, name, {\n        get() {\n          return getIvar(self, name);\n        },\n        set(v) {\n          (0, _runtime.object_setInstanceVariable)(self, name, v);\n        }\n      });\n      self[name] = defn[name];\n    });\n    // If there is a passsed-in init funciton, call it now.\n    if (typeof defn.init == 'function') defn.init.call(this);\n    return self;\n  });\n\n  return cls.registerClass();\n};\n\nfunction getIvar(obj, name) {\n  const retPtr = MOPointer.new();\n  (0, _runtime.object_getInstanceVariable)(obj, name, retPtr);\n  return retPtr.value().retain().autorelease();\n}","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.SuperCall = SuperCall;\nexports.CFunc = CFunc;\nconst objc_super_typeEncoding = '{objc_super=\"receiver\"@\"super_class\"#}';\n\n// You can store this to call your function. this must be bound to the current instance.\nfunction SuperCall(selector, argTypes, returnType) {\n  const func = CFunc(\"objc_msgSendSuper\", [{ type: '^' + objc_super_typeEncoding }, { type: \":\" }, ...argTypes], returnType);\n  return function (...args) {\n    const struct = make_objc_super(this, this.superclass());\n    const structPtr = MOPointer.alloc().initWithValue_(struct);\n    return func(structPtr, selector, ...args);\n  };\n}\n\n// Recursively create a MOStruct\nfunction makeStruct(def) {\n  if (typeof def !== 'object' || Object.keys(def).length == 0) {\n    return def;\n  }\n  const name = Object.keys(def)[0];\n  const values = def[name];\n\n  const structure = MOStruct.structureWithName_memberNames_runtime(name, Object.keys(values), Mocha.sharedRuntime());\n\n  Object.keys(values).map(member => {\n    structure[member] = makeStruct(values[member]);\n  });\n\n  return structure;\n}\n\nfunction make_objc_super(self, cls) {\n  return makeStruct({\n    objc_super: {\n      receiver: self,\n      super_class: cls\n    }\n  });\n}\n\n// Due to particularities of the JS bridge, we can't call into MOBridgeSupport objects directly\n// But, we can ask key value coding to do the dirty work for us ;)\nfunction setKeys(o, d) {\n  const funcDict = NSMutableDictionary.dictionary();\n  funcDict.o = o;\n  Object.keys(d).map(k => funcDict.setValue_forKeyPath(d[k], \"o.\" + k));\n}\n\n// Use any C function, not just ones with BridgeSupport\nfunction CFunc(name, args, retVal) {\n  function makeArgument(a) {\n    if (!a) return null;\n    const arg = MOBridgeSupportArgument.alloc().init();\n    setKeys(arg, {\n      type64: a.type\n    });\n    return arg;\n  }\n  const func = MOBridgeSupportFunction.alloc().init();\n  setKeys(func, {\n    name: name,\n    arguments: args.map(makeArgument),\n    returnValue: makeArgument(retVal)\n  });\n  return func;\n}\n\n/*\n@encode(char*) = \"*\"\n@encode(id) = \"@\"\n@encode(Class) = \"#\"\n@encode(void*) = \"^v\"\n@encode(CGRect) = \"{CGRect={CGPoint=dd}{CGSize=dd}}\"\n@encode(SEL) = \":\"\n*/\n\nfunction addStructToBridgeSupport(key, structDef) {\n  // OK, so this is probably the nastiest hack in this file.\n  // We go modify MOBridgeSupportController behind its back and use kvc to add our own definition\n  // There isn't another API for this though. So the only other way would be to make a real bridgesupport file.\n  const symbols = MOBridgeSupportController.sharedController().valueForKey('symbols');\n  if (!symbols) throw Error(\"Something has changed within bridge support so we can't add our definitions\");\n  // If someone already added this definition, don't re-register it.\n  if (symbols[key] !== null) return;\n  const def = MOBridgeSupportStruct.alloc().init();\n  setKeys(def, {\n    name: key,\n    type: structDef.type\n  });\n  symbols[key] = def;\n};\n\n// This assumes the ivar is an object type. Return value is pretty useless.\nconst object_getInstanceVariable = exports.object_getInstanceVariable = CFunc(\"object_getInstanceVariable\", [{ type: \"@\" }, { type: '*' }, { type: \"^@\" }], { type: \"^{objc_ivar=}\" });\n// Again, ivar is of object type\nconst object_setInstanceVariable = exports.object_setInstanceVariable = CFunc(\"object_setInstanceVariable\", [{ type: \"@\" }, { type: '*' }, { type: \"@\" }], { type: \"^{objc_ivar=}\" });\n\n// We need Mocha to understand what an objc_super is so we can use it as a function argument\naddStructToBridgeSupport('objc_super', { type: objc_super_typeEncoding });","var COLOR_CLASSES = [\n  'NSColor',\n  'NSCachedWhiteColor',\n  'NSColorSpaceColor',\n  'NSDynamicSystemColor',\n  'NSCachedColorSpaceColor',\n]\nfunction parseHexColor(color) {\n  // Check the string for incorrect formatting.\n  if (!color || color[0] !== '#') {\n    if (\n      color &&\n      color.class &&\n      COLOR_CLASSES.indexOf(String(color.class())) !== -1\n    ) {\n      return color\n    }\n    throw new Error(\n      'Incorrect color formating. It should be an hex color: #RRGGBBAA'\n    )\n  }\n\n  // append FF if alpha channel is not specified.\n  var source = color.substr(1)\n  if (source.length === 3) {\n    source += 'F'\n  } else if (source.length === 6) {\n    source += 'FF'\n  }\n  // Convert the string from #FFF format to #FFFFFF format.\n  var hex\n  if (source.length === 4) {\n    for (var i = 0; i < 4; i += 1) {\n      hex += source[i]\n      hex += source[i]\n    }\n  } else if (source.length === 8) {\n    hex = source\n  } else {\n    return NSColor.whiteColor()\n  }\n\n  var r = parseInt(hex.slice(0, 2), 16)\n  var g = parseInt(hex.slice(2, 4), 16)\n  var b = parseInt(hex.slice(4, 6), 16)\n  var a = parseInt(hex.slice(6, 8), 16)\n\n  return NSColor.colorWithSRGBRed_green_blue_alpha(r, g, b, a)\n}\n\nmodule.exports = function(browserWindow, panel, webview) {\n  // keep reference to the subviews\n  browserWindow._panel = panel\n  browserWindow._webview = webview\n  browserWindow._destroyed = false\n\n  browserWindow.destroy = function() {\n    return panel.close()\n  }\n\n  browserWindow.close = function() {\n    if (!browserWindow.isClosable()) {\n      return\n    }\n\n    panel.performClose(null)\n  }\n\n  function focus(focused) {\n    if (browserWindow.isVisible()) {\n      return\n    }\n    if (focused) {\n      NSApplication.sharedApplication().activateIgnoringOtherApps(true)\n      panel.makeKeyAndOrderFront(null)\n    } else {\n      panel.orderBack(null)\n    }\n  }\n\n  browserWindow.focus = focus.bind(this, true)\n  browserWindow.blur = focus.bind(this, false)\n\n  browserWindow.isFocused = function() {\n    return panel.isKeyWindow()\n  }\n\n  browserWindow.isDestroyed = function() {\n    return browserWindow._destroyed\n  }\n\n  browserWindow.show = function() {\n    // This method is supposed to put focus on window, however if the app does not\n    // have focus then \"makeKeyAndOrderFront\" will only show the window.\n    NSApp.activateIgnoringOtherApps(true)\n\n    return panel.makeKeyAndOrderFront(null)\n  }\n\n  browserWindow.showInactive = function() {\n    return panel.orderFrontRegardless()\n  }\n\n  browserWindow.hide = function() {\n    return panel.orderOut(null)\n  }\n\n  browserWindow.isVisible = function() {\n    return panel.isVisible()\n  }\n\n  browserWindow.isModal = function() {\n    return false\n  }\n\n  browserWindow.maximize = function() {\n    if (!browserWindow.isMaximized()) {\n      panel.zoom(null)\n    }\n  }\n  browserWindow.unmaximize = function() {\n    if (browserWindow.isMaximized()) {\n      panel.zoom(null)\n    }\n  }\n\n  browserWindow.isMaximized = function() {\n    if ((panel.styleMask() & NSResizableWindowMask) !== 0) {\n      return panel.isZoomed()\n    }\n    var rectScreen = NSScreen.mainScreen().visibleFrame()\n    var rectWindow = panel.frame()\n    return (\n      rectScreen.origin.x == rectWindow.origin.x &&\n      rectScreen.origin.y == rectWindow.origin.y &&\n      rectScreen.size.width == rectWindow.size.width &&\n      rectScreen.size.height == rectWindow.size.height\n    )\n  }\n\n  browserWindow.minimize = function() {\n    return panel.miniaturize(null)\n  }\n\n  browserWindow.restore = function() {\n    return panel.deminiaturize(null)\n  }\n\n  browserWindow.isMinimized = function() {\n    return panel.isMiniaturized()\n  }\n\n  browserWindow.setFullScreen = function(fullscreen) {\n    if (fullscreen !== browserWindow.isFullscreen()) {\n      panel.toggleFullScreen(null)\n    }\n  }\n\n  browserWindow.isFullscreen = function() {\n    return panel.styleMask() & NSFullScreenWindowMask\n  }\n\n  browserWindow.setAspectRatio = function(aspectRatio /* , extraSize */) {\n    // Reset the behaviour to default if aspect_ratio is set to 0 or less.\n    if (aspectRatio > 0.0) {\n      panel.setAspectRatio(NSMakeSize(aspectRatio, 1.0))\n    } else {\n      panel.setResizeIncrements(NSMakeSize(1.0, 1.0))\n    }\n  }\n\n  browserWindow.setBounds = function(bounds, animate) {\n    // Do nothing if in fullscreen mode.\n    if (browserWindow.isFullscreen()) {\n      return\n    }\n\n    // TODO: Check size constraints since setFrame does not check it.\n    var size = bounds.size\n    // size.SetToMax(GetMinimumSize());\n    // gfx::Size max_size = GetMaximumSize();\n    // if (!max_size.IsEmpty())\n    //   size.SetToMin(max_size);\n\n    var cocoaBounds = NSMakeRect(bounds.origin.x, 0, size.width, size.height)\n    // Flip coordinates based on the primary screen.\n    var screen = NSScreen.screens().firstObject()\n    cocoaBounds.origin.y =\n      NSHeight(screen.frame()) - size.height - bounds.origin.y\n\n    panel.setFrame_display_animate(cocoaBounds, true, animate)\n  }\n\n  browserWindow.getBounds = function() {\n    return panel.frame()\n  }\n\n  browserWindow.setContentBounds = function(/* bounds, animate */) {\n    // TODO:\n  }\n\n  browserWindow.getContentBounds = function() {\n    // TODO:\n  }\n\n  browserWindow.setSize = function(width, height, animate) {\n    var bounds = browserWindow.getBounds()\n    bounds.size.height = height\n    bounds.size.width = width\n\n    // TODO: handle resizing around center\n\n    return browserWindow.setBounds(bounds, animate)\n  }\n\n  browserWindow.getSize = function() {\n    var bounds = browserWindow.getBounds()\n    return [bounds.size.width, bounds.size.height]\n  }\n\n  browserWindow.setContentSize = function(width, height, animate) {\n    var bounds = browserWindow.getContentBounds()\n    bounds.size.height = height\n    bounds.size.width = width\n\n    // TODO: handle resizing around center\n\n    return browserWindow.setContentBounds(bounds, animate)\n  }\n\n  browserWindow.getContentSize = function() {\n    var bounds = browserWindow.getContentBounds()\n    return [bounds.size.width, bounds.size.height]\n  }\n\n  browserWindow.setMinimumSize = function(width, height) {\n    const minSize = { width: width, height: height }\n    panel.setContentMinSize(minSize)\n  }\n\n  browserWindow.getMinimumSize = function() {\n    const size = panel.contentMinSize()\n    return [size.width, size.height]\n  }\n\n  browserWindow.setMaximumSize = function(width, height) {\n    const minSize = { width: width, height: height }\n    panel.setContentMaxSize(minSize)\n  }\n\n  browserWindow.getMaximumSize = function() {\n    const size = panel.contentMaxSize()\n    return [size.width, size.height]\n  }\n\n  browserWindow.setResizable = function(resizable) {\n    return browserWindow._setStyleMask(resizable, NSResizableWindowMask)\n  }\n\n  browserWindow.isResizable = function() {\n    return panel.styleMask() & NSResizableWindowMask\n  }\n\n  browserWindow.setMovable = function(movable) {\n    return panel.setMovable(movable)\n  }\n  browserWindow.isMovable = function() {\n    return panel.isMovable()\n  }\n\n  browserWindow.setMinimizable = function(minimizable) {\n    return browserWindow._setStyleMask(minimizable, NSMiniaturizableWindowMask)\n  }\n\n  browserWindow.isMinimizable = function() {\n    return panel.styleMask() & NSMiniaturizableWindowMask\n  }\n\n  browserWindow.setMaximizable = function(maximizable) {\n    if (panel.standardWindowButton(NSWindowZoomButton)) {\n      panel.standardWindowButton(NSWindowZoomButton).setEnabled(maximizable)\n    }\n  }\n\n  browserWindow.isMaximizable = function() {\n    return (\n      panel.standardWindowButton(NSWindowZoomButton) &&\n      panel.standardWindowButton(NSWindowZoomButton).isEnabled()\n    )\n  }\n\n  browserWindow.setFullScreenable = function(fullscreenable) {\n    browserWindow._setCollectionBehavior(\n      fullscreenable,\n      NSWindowCollectionBehaviorFullScreenPrimary\n    )\n    // On EL Capitan this flag is required to hide fullscreen button.\n    browserWindow._setCollectionBehavior(\n      !fullscreenable,\n      NSWindowCollectionBehaviorFullScreenAuxiliary\n    )\n  }\n\n  browserWindow.isFullScreenable = function() {\n    var collectionBehavior = panel.collectionBehavior()\n    return collectionBehavior & NSWindowCollectionBehaviorFullScreenPrimary\n  }\n\n  browserWindow.setClosable = function(closable) {\n    browserWindow._setStyleMask(closable, NSClosableWindowMask)\n  }\n\n  browserWindow.isClosable = function() {\n    return panel.styleMask() & NSClosableWindowMask\n  }\n\n  browserWindow.setAlwaysOnTop = function(top, level, relativeLevel) {\n    var windowLevel = NSNormalWindowLevel\n    var maxWindowLevel = CGWindowLevelForKey(kCGMaximumWindowLevelKey)\n    var minWindowLevel = CGWindowLevelForKey(kCGMinimumWindowLevelKey)\n\n    if (top) {\n      if (level === 'normal') {\n        windowLevel = NSNormalWindowLevel\n      } else if (level === 'torn-off-menu') {\n        windowLevel = NSTornOffMenuWindowLevel\n      } else if (level === 'modal-panel') {\n        windowLevel = NSModalPanelWindowLevel\n      } else if (level === 'main-menu') {\n        windowLevel = NSMainMenuWindowLevel\n      } else if (level === 'status') {\n        windowLevel = NSStatusWindowLevel\n      } else if (level === 'pop-up-menu') {\n        windowLevel = NSPopUpMenuWindowLevel\n      } else if (level === 'screen-saver') {\n        windowLevel = NSScreenSaverWindowLevel\n      } else if (level === 'dock') {\n        // Deprecated by macOS, but kept for backwards compatibility\n        windowLevel = NSDockWindowLevel\n      } else {\n        windowLevel = NSFloatingWindowLevel\n      }\n    }\n\n    var newLevel = windowLevel + (relativeLevel || 0)\n    if (newLevel >= minWindowLevel && newLevel <= maxWindowLevel) {\n      panel.setLevel(newLevel)\n    } else {\n      throw new Error(\n        'relativeLevel must be between ' +\n          minWindowLevel +\n          ' and ' +\n          maxWindowLevel\n      )\n    }\n  }\n\n  browserWindow.isAlwaysOnTop = function() {\n    return panel.level() !== NSNormalWindowLevel\n  }\n\n  browserWindow.moveTop = function() {\n    return panel.orderFrontRegardless()\n  }\n\n  browserWindow.center = function() {\n    panel.center()\n  }\n\n  browserWindow.setPosition = function(x, y, animate) {\n    var bounds = browserWindow.getBounds()\n    var mainScreenRect = NSScreen.screens()\n      .firstObject()\n      .frame()\n    bounds.origin.x = x\n    bounds.origin.y = Math.round(NSHeight(mainScreenRect) - y)\n\n    return browserWindow.setBounds(bounds, animate)\n  }\n\n  browserWindow.getPosition = function() {\n    var bounds = browserWindow.getBounds()\n    var mainScreenRect = NSScreen.screens()\n      .firstObject()\n      .frame()\n    return [\n      bounds.origin.x,\n      Math.round(NSHeight(mainScreenRect) - bounds.origin.y),\n    ]\n  }\n\n  browserWindow.setTitle = function(title) {\n    panel.setTitle(title)\n  }\n\n  browserWindow.getTitle = function() {\n    return String(panel.title())\n  }\n\n  var attentionRequestId = 0\n  browserWindow.flashFrame = function(flash) {\n    if (flash) {\n      attentionRequestId = NSApp.requestUserAttention(NSInformationalRequest)\n    } else {\n      NSApp.cancelUserAttentionRequest(attentionRequestId)\n      attentionRequestId = 0\n    }\n  }\n\n  browserWindow.getNativeWindowHandle = function() {\n    return panel\n  }\n\n  browserWindow.getNativeWebViewHandle = function() {\n    return webview\n  }\n\n  browserWindow.loadURL = function(url) {\n    // When frameLocation is a file, prefix it with the Sketch Resources path\n    if (/^(?!http|localhost|www|file).*\\.html?$/.test(url)) {\n      if (typeof __command !== 'undefined' && __command.pluginBundle()) {\n        url = __command\n          .pluginBundle()\n          .urlForResourceNamed(url)\n          .path()\n      }\n    }\n    webview.setMainFrameURL(url)\n  }\n\n  browserWindow.reload = function() {\n    webview.reload()\n  }\n\n  browserWindow.setHasShadow = function(hasShadow) {\n    return panel.setHasShadow(hasShadow)\n  }\n\n  browserWindow.hasShadow = function() {\n    return panel.hasShadow()\n  }\n\n  browserWindow.setOpacity = function(opacity) {\n    return panel.setAlphaValue(opacity)\n  }\n\n  browserWindow.getOpacity = function() {\n    return panel.alphaValue()\n  }\n\n  browserWindow.setVisibleOnAllWorkspaces = function(visible) {\n    return browserWindow._setCollectionBehavior(\n      visible,\n      NSWindowCollectionBehaviorCanJoinAllSpaces\n    )\n  }\n\n  browserWindow.isVisibleOnAllWorkspaces = function() {\n    var collectionBehavior = panel.collectionBehavior()\n    return collectionBehavior & NSWindowCollectionBehaviorCanJoinAllSpaces\n  }\n\n  browserWindow.setIgnoreMouseEvents = function(ignore) {\n    return panel.setIgnoresMouseEvents(ignore)\n  }\n\n  browserWindow.setContentProtection = function(enable) {\n    panel.setSharingType(enable ? NSWindowSharingNone : NSWindowSharingReadOnly)\n  }\n\n  browserWindow.setAutoHideCursor = function(autoHide) {\n    panel.setDisableAutoHideCursor(autoHide)\n  }\n\n  browserWindow.setVibrancy = function(type) {\n    var effectView = browserWindow._vibrantView\n\n    if (!type) {\n      if (effectView == null) {\n        return\n      }\n\n      effectView.removeFromSuperview()\n      panel.setVibrantView(null)\n      return\n    }\n\n    if (effectView == null) {\n      var contentView = panel.contentView()\n      effectView = NSVisualEffectView.alloc().initWithFrame(\n        contentView.bounds()\n      )\n      browserWindow._vibrantView = effectView\n\n      effectView.setAutoresizingMask(NSViewWidthSizable | NSViewHeightSizable)\n      effectView.setBlendingMode(NSVisualEffectBlendingModeBehindWindow)\n      effectView.setState(NSVisualEffectStateActive)\n      effectView.setFrame(contentView.bounds())\n      contentView.addSubview_positioned_relativeTo(\n        effectView,\n        NSWindowBelow,\n        null\n      )\n    }\n\n    var vibrancyType = NSVisualEffectMaterialLight\n\n    if (type === 'appearance-based') {\n      vibrancyType = NSVisualEffectMaterialAppearanceBased\n    } else if (type === 'light') {\n      vibrancyType = NSVisualEffectMaterialLight\n    } else if (type === 'dark') {\n      vibrancyType = NSVisualEffectMaterialDark\n    } else if (type === 'titlebar') {\n      vibrancyType = NSVisualEffectMaterialTitlebar\n    } else if (type === 'selection') {\n      vibrancyType = NSVisualEffectMaterialSelection\n    } else if (type === 'menu') {\n      vibrancyType = NSVisualEffectMaterialMenu\n    } else if (type === 'popover') {\n      vibrancyType = NSVisualEffectMaterialPopover\n    } else if (type === 'sidebar') {\n      vibrancyType = NSVisualEffectMaterialSidebar\n    } else if (type === 'medium-light') {\n      vibrancyType = NSVisualEffectMaterialMediumLight\n    } else if (type === 'ultra-dark') {\n      vibrancyType = NSVisualEffectMaterialUltraDark\n    }\n\n    effectView.setMaterial(vibrancyType)\n  }\n\n  browserWindow._setBackgroundColor = function(colorName) {\n    var color = parseHexColor(colorName)\n    webview.setDrawsBackground(false)\n    panel.backgroundColor = color\n  }\n\n  browserWindow._invalidate = function() {\n    panel.flushWindow()\n    panel.contentView().setNeedsDisplay(true)\n  }\n\n  browserWindow._setStyleMask = function(on, flag) {\n    var wasMaximizable = browserWindow.isMaximizable()\n    if (on) {\n      panel.setStyleMask(panel.styleMask() | flag)\n    } else {\n      panel.setStyleMask(panel.styleMask() & ~flag)\n    }\n    // Change style mask will make the zoom button revert to default, probably\n    // a bug of Cocoa or macOS.\n    browserWindow.setMaximizable(wasMaximizable)\n  }\n\n  browserWindow._setCollectionBehavior = function(on, flag) {\n    var wasMaximizable = browserWindow.isMaximizable()\n    if (on) {\n      panel.setCollectionBehavior(panel.collectionBehavior() | flag)\n    } else {\n      panel.setCollectionBehavior(panel.collectionBehavior() & ~flag)\n    }\n    // Change collectionBehavior will make the zoom button revert to default,\n    // probably a bug of Cocoa or macOS.\n    browserWindow.setMaximizable(wasMaximizable)\n  }\n\n  browserWindow._showWindowButton = function(button) {\n    var view = panel.standardWindowButton(button)\n    view.superview().addSubview_positioned_relative(view, NSWindowAbove, null)\n  }\n}\n","module.exports = {\n  JS_BRIDGE: '__skpm_sketchBridge',\n}\n","var tagsToFocus =\n  '[\"text\", \"textarea\", \"date\", \"datetime-local\", \"email\", \"number\", \"month\", \"password\", \"search\", \"tel\", \"time\", \"url\", \"week\" ]'\n\nmodule.exports = function(webView, event) {\n  var point = webView.convertPoint_fromView(event.locationInWindow(), null)\n  var x = point.x\n  var y = webView.frame().size.height - point.y // the coord start from the bottom instead of the top\n  return (\n    'var el = document.elementFromPoint(' + // get the DOM element that match the event\n    x +\n    ', ' +\n    y +\n    '); ' +\n    'if (el && ' + // some tags need to be focused instead of clicked\n    tagsToFocus +\n    '.indexOf(el.type) >= 0 && ' +\n    'el.focus' +\n    ') {' +\n    'el.focus();' + // so focus them\n    '} else if (el) {' +\n    'el.dispatchEvent(new Event(\"click\", {bubbles: true}))' + // click the others\n    '}'\n  )\n}\n","function addEdgeConstraint(edge, subview, view, constant) {\n  view.addConstraint(\n    NSLayoutConstraint.constraintWithItem_attribute_relatedBy_toItem_attribute_multiplier_constant(\n      subview,\n      edge,\n      NSLayoutRelationEqual,\n      view,\n      edge,\n      1,\n      constant\n    )\n  )\n}\nmodule.exports = function fitSubviewToView(subview, view, constants) {\n  constants = constants || []\n  subview.setTranslatesAutoresizingMaskIntoConstraints(false)\n\n  addEdgeConstraint(NSLayoutAttributeLeft, subview, view, constants[0] || 0)\n  addEdgeConstraint(NSLayoutAttributeTop, subview, view, constants[1] || 0)\n  addEdgeConstraint(NSLayoutAttributeRight, subview, view, constants[2] || 0)\n  addEdgeConstraint(NSLayoutAttributeBottom, subview, view, constants[3] || 0)\n}\n","/* let's try to match the API from Electron's Browser window\n(https://github.com/electron/electron/blob/master/docs/api/browser-window.md) */\nvar EventEmitter = require('@skpm/events')\nvar buildBrowserAPI = require('./browser-api')\nvar buildWebAPI = require('./webview-api')\nvar fitSubviewToView = require('./fitSubview')\nvar dispatchFirstClick = require('./dispatch-first-click')\nvar setDelegates = require('./set-delegates')\n\nfunction BrowserWindow(options) {\n  options = options || {}\n\n  var identifier = options.identifier || NSUUID.UUID().UUIDString()\n  var threadDictionary = NSThread.mainThread().threadDictionary()\n\n  var existingBrowserWindow = BrowserWindow.fromId(identifier)\n\n  // if we already have a window opened, reuse it\n  if (existingBrowserWindow) {\n    return existingBrowserWindow\n  }\n\n  var browserWindow = new EventEmitter()\n  browserWindow.id = identifier\n\n  // Long-running script\n  var fiber\n  try {\n    fiber = coscript.createFiber()\n  } catch (err) {\n    coscript.shouldKeepAround = true\n  }\n\n  // Window size\n  var width = options.width || 800\n  var height = options.height || 600\n  var mainScreenRect = NSScreen.screens()\n    .firstObject()\n    .frame()\n  var cocoaBounds = NSMakeRect(\n    typeof options.x !== 'undefined'\n      ? options.x\n      : Math.round((NSWidth(mainScreenRect) - width) / 2),\n    typeof options.y !== 'undefined'\n      ? options.y\n      : Math.round((NSHeight(mainScreenRect) - height) / 2),\n    width,\n    height\n  )\n\n  if (options.titleBarStyle && options.titleBarStyle !== 'default') {\n    options.frame = false\n  }\n\n  var useStandardWindow = options.windowType !== 'textured'\n  var styleMask = NSTitledWindowMask\n\n  // this is commented out because the toolbar doesn't appear otherwise :thinking-face:\n  // if (!useStandardWindow || options.frame === false) {\n  //   styleMask = NSFullSizeContentViewWindowMask\n  // }\n  if (options.minimizable !== false) {\n    styleMask |= NSMiniaturizableWindowMask\n  }\n  if (options.closable !== false) {\n    styleMask |= NSClosableWindowMask\n  }\n  if (options.resizable !== false) {\n    styleMask |= NSResizableWindowMask\n  }\n  if (!useStandardWindow || options.transparent || options.frame === false) {\n    styleMask |= NSTexturedBackgroundWindowMask\n  }\n\n  // TODO: handle modal mode\n\n  var panel = NSPanel.alloc().initWithContentRect_styleMask_backing_defer(\n    cocoaBounds,\n    styleMask,\n    NSBackingStoreBuffered,\n    true\n  )\n\n  var webView = WebView.alloc().initWithFrame(\n    NSMakeRect(0, 0, options.width || 800, options.height || 600)\n  )\n  webView.setAutoresizingMask(NSViewWidthSizable | NSViewHeightSizable)\n\n  buildBrowserAPI(browserWindow, panel, webView)\n  buildWebAPI(browserWindow, panel, webView)\n  setDelegates(browserWindow, panel, webView)\n\n  if (options.windowType === 'desktop') {\n    panel.setLevel(kCGDesktopWindowLevel - 1)\n    // panel.setCanBecomeKeyWindow(false)\n    panel.setCollectionBehavior(\n      NSWindowCollectionBehaviorCanJoinAllSpaces |\n        NSWindowCollectionBehaviorStationary |\n        NSWindowCollectionBehaviorIgnoresCycle\n    )\n  }\n\n  if (\n    typeof options.minWidth !== 'undefined' ||\n    typeof options.minHeight !== 'undefined'\n  ) {\n    browserWindow.setMinimumSize(options.minWidth || 0, options.minHeight || 0)\n  }\n\n  if (\n    typeof options.maxWidth !== 'undefined' ||\n    typeof options.maxHeight !== 'undefined'\n  ) {\n    browserWindow.setMaximumSize(\n      options.maxWidth || 10000,\n      options.maxHeight || 10000\n    )\n  }\n\n  // if (options.focusable === false) {\n  //   panel.setCanBecomeKeyWindow(false)\n  // }\n\n  if (options.transparent || options.frame === false) {\n    panel.titlebarAppearsTransparent = true\n    panel.titleVisibility = NSWindowTitleHidden\n    panel.setOpaque(0)\n    panel.isMovableByWindowBackground = true\n    var toolbar2 = NSToolbar.alloc().initWithIdentifier(\n      'titlebarStylingToolbar'\n    )\n    toolbar2.setShowsBaselineSeparator(false)\n    panel.setToolbar(toolbar2)\n  }\n\n  if (options.titleBarStyle === 'hiddenInset') {\n    var toolbar = NSToolbar.alloc().initWithIdentifier('titlebarStylingToolbar')\n    toolbar.setShowsBaselineSeparator(false)\n    panel.setToolbar(toolbar)\n  }\n\n  if (options.frame === false || !options.useContentSize) {\n    browserWindow.setSize(width, height)\n  }\n\n  if (options.center) {\n    browserWindow.center()\n  }\n\n  if (options.alwaysOnTop) {\n    browserWindow.setAlwaysOnTop(true)\n  }\n\n  if (options.fullscreen) {\n    browserWindow.setFullScreen(true)\n  }\n  browserWindow.setFullScreenable(!!options.fullscreenable)\n\n  const title =\n    options.title ||\n    (typeof __command !== 'undefined' && __command.pluginBundle()\n      ? __command.pluginBundle().name()\n      : undefined)\n  if (title) {\n    browserWindow.setTitle(title)\n  }\n\n  var backgroundColor = options.backgroundColor\n  if (options.transparent) {\n    backgroundColor = NSColor.clearColor()\n  }\n  if (!backgroundColor && options.frame === false && options.vibrancy) {\n    backgroundColor = NSColor.clearColor()\n  }\n\n  browserWindow._setBackgroundColor(\n    backgroundColor || NSColor.windowBackgroundColor()\n  )\n\n  if (options.hasShadow === false) {\n    browserWindow.setHasShadow(false)\n  }\n\n  if (typeof options.opacity !== 'undefined') {\n    browserWindow.setOpacity(options.opacity)\n  }\n\n  if (options.webPreferences) {\n    // TODO:\n  }\n\n  var contentView = panel.contentView()\n\n  if (options.frame !== false) {\n    webView.setFrame(contentView.bounds())\n    contentView.addSubview(webView)\n  } else {\n    // In OSX 10.10, adding subviews to the root view for the NSView hierarchy\n    // produces warnings. To eliminate the warnings, we resize the contentView\n    // to fill the window, and add subviews to that.\n    // http://crbug.com/380412\n    contentView.setAutoresizingMask(NSViewWidthSizable | NSViewHeightSizable)\n    fitSubviewToView(contentView, contentView.superview())\n\n    webView.setFrame(contentView.bounds())\n    contentView.addSubview(webView)\n\n    // The fullscreen button should always be hidden for frameless window.\n    if (panel.standardWindowButton(NSWindowFullScreenButton)) {\n      panel.standardWindowButton(NSWindowFullScreenButton).setHidden(true)\n    }\n\n    if (!options.titleBarStyle || options.titleBarStyle === 'default') {\n      // Hide the window buttons.\n      panel.standardWindowButton(NSWindowZoomButton).setHidden(true)\n      panel.standardWindowButton(NSWindowMiniaturizeButton).setHidden(true)\n      panel.standardWindowButton(NSWindowCloseButton).setHidden(true)\n\n      // Some third-party macOS utilities check the zoom button's enabled state to\n      // determine whether to show custom UI on hover, so we disable it here to\n      // prevent them from doing so in a frameless app window.\n      panel.standardWindowButton(NSWindowZoomButton).setEnabled(false)\n    }\n  }\n\n  if (options.vibrancy) {\n    browserWindow.setVibrancy(options.vibrancy)\n  }\n\n  // Set maximizable state last to ensure zoom button does not get reset\n  // by calls to other APIs.\n  browserWindow.setMaximizable(options.maximizable !== false)\n\n  if (options.acceptsFirstMouse) {\n    browserWindow.on('focus', function(event) {\n      if (event.type() === NSEventTypeLeftMouseDown) {\n        browserWindow.webContents.executeJavaScript(\n          dispatchFirstClick(webView, event)\n        )\n      }\n    })\n  }\n\n  if (options.show !== false) {\n    browserWindow.show()\n  }\n\n  browserWindow.on('closed', function() {\n    browserWindow._destroyed = true\n    threadDictionary.removeObjectForKey(identifier)\n    if (fiber) {\n      fiber.cleanup()\n    } else {\n      coscript.shouldKeepAround = false\n    }\n  })\n\n  threadDictionary[identifier] = panel\n\n  if (fiber) {\n    fiber.onCleanup(function() {\n      if (!browserWindow._destroyed) {\n        browserWindow.destroy()\n      }\n    })\n  }\n\n  return browserWindow\n}\n\nBrowserWindow.fromId = function(identifier) {\n  var threadDictionary = NSThread.mainThread().threadDictionary()\n\n  if (threadDictionary[identifier]) {\n    return BrowserWindow.fromPanel(threadDictionary[identifier], identifier)\n  }\n\n  return undefined\n}\n\nBrowserWindow.fromPanel = function(panel, identifier) {\n  var browserWindow = new EventEmitter()\n  browserWindow.id = identifier\n\n  if (!panel || !panel.contentView) {\n    throw new Error('needs to pass an NSPanel')\n  }\n\n  var webView = panel.contentView().subviews()[0]\n\n  if (!webView) {\n    throw new Error('The NSPanel needs to have a webview')\n  }\n\n  buildBrowserAPI(browserWindow, panel, webView)\n  buildWebAPI(browserWindow, panel, webView)\n\n  return browserWindow\n}\n\nmodule.exports = BrowserWindow\n","module.exports = function(webArguments) {\n  var args = null\n  try {\n    args = JSON.parse(webArguments[0])\n  } catch (e) {\n    // malformed arguments\n  }\n\n  if (\n    !args ||\n    !args.constructor ||\n    args.constructor !== Array ||\n    args.length == 0\n  ) {\n    return null\n  }\n\n  return args\n}\n","var ObjCClass = require('cocoascript-class').default\nvar parseWebArguments = require('./parseWebArguments')\nvar CONSTANTS = require('./constants')\n\n// We create one ObjC class for ourselves here\nvar WindowDelegateClass\nvar FrameLoadDelegateClass\n\nmodule.exports = function(browserWindow, panel, webview) {\n  if (!WindowDelegateClass) {\n    WindowDelegateClass = ObjCClass({\n      classname: 'WindowDelegateClass',\n      utils: null,\n\n      // Tells the delegate that the window has been resized.\n      'windowDidResize:': function() {\n        this.utils.emit('resize')\n      },\n\n      // Tells the delegate that the window has been resized.\n      'windowDidMiniaturize:': function() {\n        this.utils.emit('minimize')\n      },\n\n      // Tells the delegate that the window has been resized.\n      'windowDidDeminiaturize:': function() {\n        this.utils.emit('restore')\n      },\n\n      // Tells the delegate that the window has been resized.\n      'windowDidEnterFullScreen:': function() {\n        this.utils.emit('enter-full-screen')\n      },\n\n      // Tells the delegate that the window has been resized.\n      'windowDidExitFullScreen:': function() {\n        this.utils.emit('leave-full-screen')\n      },\n\n      // Tells the delegate that the window has been resized.\n      'windowDidMove:': function() {\n        this.utils.emit('move')\n        this.utils.emit('moved')\n      },\n\n      // Tells the delegate that the window has been resized.\n      'windowShouldClose:': function() {\n        var shouldClose = true\n        this.utils.emit('close', {\n          get defaultPrevented() {\n            return !shouldClose\n          },\n          preventDefault: function() {\n            shouldClose = false\n          },\n        })\n        return shouldClose\n      },\n\n      'windowWillClose:': function() {\n        this.utils.emit('closed')\n      },\n\n      'windowDidBecomeKey:': function() {\n        this.utils.emit('focus', panel.currentEvent())\n      },\n\n      'windowDidResignKey:': function() {\n        this.utils.emit('blur')\n      },\n    })\n  }\n\n  if (!FrameLoadDelegateClass) {\n    FrameLoadDelegateClass = ObjCClass({\n      classname: 'FrameLoadDelegateClass',\n      state: NSMutableDictionary.dictionaryWithDictionary({\n        lastQueryId: null,\n        wasReady: 0,\n      }),\n      utils: null,\n\n      // // Called when a client redirect is cancelled.\n      // 'webView:didCancelClientRedirectForFrame:': function (\n      //   webView,\n      //   webFrame\n      // ) {},\n\n      // Called when the scroll position within a frame changes.\n      'webView:didChangeLocationWithinPageForFrame:': function(webView) {\n        this.utils.emit('did-navigate-in-page', [\n          {},\n          String(\n            webView.stringByEvaluatingJavaScriptFromString(\n              'window.location.href'\n            )\n          ),\n        ])\n      },\n\n      // // Called when the JavaScript window object in a frame is ready for loading.\n      // 'webView:didClearWindowObject:forFrame:': function (\n      //   webView,\n      //   windowObject,\n      //   webFrame\n      // ) {},\n\n      // // Called when content starts arriving for a page load.\n      // 'webView:didCommitLoadforFrame:': function (webView, webFrame) {},\n\n      // // Notifies the delegate that a new JavaScript context has been created.\n      // N.B - we intentionally omit the 2nd parameter (javascriptContext)\n      // It was causing crashes in Sketch - possibly because of issues with converting\n      // it from Objective C to Javascript\n      'webView:didCreateJavaScriptContext:forFrame:': function(webView) {\n        // any time there is a new js context, set a global value (on window.) to refer\n        // to this frameloaddelegate class\n        webView.windowScriptObject().setValue_forKey_(this, CONSTANTS.JS_BRIDGE)\n      },\n\n      // the normal way to expose a selector to webscript is with 'isSelectorExcludedFromWebScript:'\n      // but that didn't work, so this is an alternative. This method gets invoked any time\n      // an unknown method is called on this class by webscript\n      'invokeUndefinedMethodFromWebScript:withArguments:': function(\n        method,\n        webArguments\n      ) {\n        if (String(method) !== 'callNative') {\n          return false\n        }\n\n        var args = this.utils.parseWebArguments(webArguments)\n        if (!args) {\n          return false\n        }\n\n        this.utils.emit.apply(this, args)\n        return true\n      },\n\n      // Called when an error occurs loading a committed data source.\n      'webView:didFailLoadWithError:forFrame:': function(_, error) {\n        this.utils.emit('did-fail-load', error)\n      },\n\n      // Called when a page load completes.\n      'webView:didFinishLoadForFrame:': function() {\n        if (this.state.wasReady == 0) {\n          // eslint-disable-line\n          this.utils.emitBrowserEvent('ready-to-show')\n          this.state.setObject_forKey(1, 'wasReady')\n        }\n        this.utils.emit('did-finish-load')\n        this.utils.emit('did-frame-finish-load')\n        this.utils.emit('dom-ready')\n      },\n\n      // Called when a provisional data source for a frame receives a server redirect.\n      'webView:didReceiveServerRedirectForProvisionalLoadForFrame:': function() {\n        this.utils.emit('did-get-redirect-request')\n      },\n\n      // Called when the page title of a frame loads or changes.\n      'webView:didReceiveTitle:forFrame:': function(_, _title) {\n        var title = String(_title)\n        var shouldChangeTitle = true\n        this.utils.emitBrowserEvent(\n          'page-title-updated',\n          {\n            get defaultPrevented() {\n              return !shouldChangeTitle\n            },\n            preventDefault: function() {\n              shouldChangeTitle = false\n            },\n          },\n          title\n        )\n\n        if (shouldChangeTitle && title) {\n          this.utils.setTitle(title)\n        }\n      },\n\n      // Called when a page load is in progress in a given frame.\n      'webView:didStartProvisionalLoadForFrame:': function() {\n        this.utils.emit('did-start-loading')\n      },\n\n      // Called when a frame will be closed.\n      // 'webView:willCloseFrame:': function (webView, webFrame) {}\n\n      // Called when a frame receives a client redirect and before it is fired.\n      'webView:willPerformClientRedirectToURL:delay:fireDate:forFrame:': function(\n        _,\n        url\n      ) {\n        this.utils.emit('will-navigate', {}, String(url.absoluteString))\n      },\n    })\n  }\n\n  var frameLoadDelegate = FrameLoadDelegateClass.new()\n  frameLoadDelegate.utils = NSDictionary.dictionaryWithDictionary({\n    setTitle: browserWindow.setTitle.bind(browserWindow),\n    emitBrowserEvent: browserWindow.emit.bind(browserWindow),\n    emit: browserWindow.webContents.emit.bind(browserWindow.webContents),\n    parseWebArguments: parseWebArguments,\n  })\n  // reset state as well\n  frameLoadDelegate.state = NSMutableDictionary.dictionaryWithDictionary({\n    lastQueryId: null,\n    wasReady: 0,\n  })\n\n  webview.setFrameLoadDelegate(frameLoadDelegate)\n\n  var windowDelegate = WindowDelegateClass.new()\n  windowDelegate.utils = NSDictionary.dictionaryWithDictionary({\n    emit: browserWindow.emit.bind(browserWindow),\n  })\n\n  panel.setDelegate(windowDelegate)\n}\n","var EventEmitter = require('@skpm/events')\n\n// let's try to match https://github.com/electron/electron/blob/master/docs/api/web-contents.md\nmodule.exports = function buildAPI(browserWindow, panel, webview) {\n  var webContents = new EventEmitter()\n\n  webContents.loadURL = browserWindow.loadURL\n  webContents.getURL = webview.mainFrameURL\n  webContents.getTitle = webview.mainFrameTitle\n  webContents.isDestroyed = function() {\n    // TODO:\n  }\n  webContents.isLoading = function() {\n    return webview.loading()\n  }\n  webContents.stop = webview.stopLoading\n  webContents.reload = webview.reload\n  webContents.canGoBack = webview.canGoBack\n  webContents.canGoForward = webview.canGoForward\n  webContents.goBack = webview.goBack\n  webContents.goForward = webview.goForward\n  webContents.executeJavaScript = function(script) {\n    return webview.stringByEvaluatingJavaScriptFromString(script)\n  }\n  webContents.undo = function() {\n    webview.undoManager().undo()\n  }\n  webContents.redo = function() {\n    webview.undoManager().redo()\n  }\n  webContents.cut = webview.cut\n  webContents.copy = webview.copy\n  webContents.paste = webview.paste\n  webContents.pasteAndMatchStyle = webview.pasteAsRichText\n  webContents.delete = webview.delete\n  webContents.replace = webview.replaceSelectionWithText\n  webContents.getNativeWebview = function() {\n    return webview\n  }\n\n  browserWindow.webContents = webContents\n}\n","/* globals NSThread */\nvar BrowserWindow = require('./lib')\n\nvar threadDictionary = NSThread.mainThread().threadDictionary()\n\nmodule.exports.getWebview = function getWebview(identifier) {\n  var panel = threadDictionary[identifier]\n  if (!panel) {\n    return undefined\n  }\n  return BrowserWindow.fromPanel(panel, identifier)\n}\n\nmodule.exports.isWebviewPresent = function isWebviewPresent(identifier) {\n  return !!threadDictionary[identifier]\n}\n\nmodule.exports.sendToWebview = function sendToWebview(identifier, evalString) {\n  var browserView = module.exports.getWebview(identifier)\n\n  if (!browserView) {\n    throw new Error('Webview ' + identifier + ' not found')\n  }\n\n  return browserView.webContents.executeJavaScript(evalString)\n}\n","import BrowserWindow from 'sketch-module-web-view';//引入webview的model\n//import {UI} from 'sketch/ui';\nimport {getStyle} from './style';\nimport { isWebviewPresent, sendToWebview } from 'sketch-module-web-view/remote';\n\n\n////////////////////////////////////////////////////////////////////////////////\n\n// Using JSTalk clipboard handling snippet from https://gist.github.com/uhunkler/5465857 by Urs Hunkler\nconst clipboard = {\n  // store the pasetboard object\n  pasteBoard : null,\n\n  // save the pasteboard object\n  init : function()\n  {\n    this.pasteBoard = NSPasteboard.generalPasteboard();\n  },\n  // set the clipboard to the given text\n  set : function( text )\n  {\n    if( typeof text === 'undefined' ) return null;\n\n    if( !this.pasteBoard )\n      this.init();\n\n    this.pasteBoard.declareTypes_owner( [ NSPasteboardTypeString ], null );\n    this.pasteBoard.setString_forType( text, NSPasteboardTypeString );\n\n    return true;\n  },\n  // get text from the clipbaoard\n  get : function()\n  {\n    if( !this.pasteBoard )\n      this.init();\n\n    var text = this.pasteBoard.stringForType( NSPasteboardTypeString );\n\n    return text.toString();\n  }\n};\n////////////////////////////////////////////////////////////////////////////////\nexport function onSelectionChanged(context) {\n\tconst selection = context.actionContext.document.selectedLayers().layers();\n\tlog('onSelectionChanged');\n\tconst options = {\n\t    \tidentifier: 'unique.id',\n\t    \twidth: 500,\n\t    \theight: 600,\n\t    \tshow: false\n\t    };\n  \tif (isWebviewPresent('unique.id')) {\n  \t\tlog('isWebviewPresent');\n\t\t\n\t  \t\t\n\t  \t//win.show();\n\n\t\tlet style = getStyle(selection);\n\t\tlog('style:' + style);\n\t\tlet replaceCSS = style.replace(/<br>/g, \"\\r\");\n  \t\tlog('replaceCSS:' + replaceCSS);\n\t\tsendToWebview(\"unique.id\",\"updatePreview('\" + style + \"')\");\n\t\t//UI.message(\"已复制CSS样式到剪贴板~\");\n    \tclipboard.set(replaceCSS);\n\t\t\n\t}else{\n\t\tlog('not isWebviewPresent');\n\t\tconst win = new BrowserWindow(options);\n\t\twin.loadURL('../Resources/panel.html');\n\t\twin.once('ready-to-show', () => {\n\t  \t\tlet style = \"\";\n\t  \t\t\n\t  \t\twin.show();\n\n\t\t\tstyle = getStyle(selection);\n\t\t\t  \tlog('style:' + style);\n\t\t\twin.webContents.executeJavaScript(\n\t  \t\t\t\t\"updatePreview('\" + style + \"')\"\n\t\t\t);\n\t\t\t//UI.message(\"已复制CSS样式到剪贴板~\");\n\t\t\tlet replaceCSS = style.replace(/<br>/g, \"\\r\");\n  \t\t\tlog('replaceCSS:' + replaceCSS);\n    \t\tclipboard.set(replaceCSS);\n\t\t  \t\n\t\t});\n\t}\n\t\n};","import {getSettings} from './unit';\n\n////////////////////////////////////////////////////////////////////////////////\n//获取图层的宽高位置数据\nconst getRect = function(layer){\n     let rect = layer.absoluteRect();\n        return {\n            x: Math.round(rect.x()),\n            y: Math.round(rect.y()),\n            width: Math.round(rect.width()),\n            height: Math.round(rect.height()),\n            maxX: Math.round(rect.x() + rect.width()),\n            maxY: Math.round(rect.y() + rect.height()),\n            setX: function(x){ rect.setX(x); this.x = x; this.maxX = this.x + this.width; },\n            setY: function(y){ rect.setY(y); this.y = y; this.maxY = this.y + this.height; },\n            setWidth: function(width){ rect.setWidth(width); this.width = width; this.maxX = this.x + this.width; },\n            setHeight: function(height){ rect.setHeight(height); this.height = height; this.maxY = this.y + this.height; }\n        };\n    };\n////////////////////////////////////////////////////////////////////////////////\n//转换图层的宽高单位\nconst convertUnit = function(rect,settings){\n        //log(\"width:\"+rect.width * 100/750+ \"vw;\");\n        //log(\"height:\"+rect.height * 100/750+ \"vw;\");\n        let widthUnit = settings.width,\n            heightUnit = settings.height;\n        let textCSS = \"\";\n        switch(widthUnit){\n          case \"px@0.5x\":\n            textCSS +=  \"width:\" + (rect.width / 2) + \"px;<br>\";\n            break;\n          case \"px\":\n            textCSS +=  \"width:\" + rect.width  + \"px;<br>\";\n            break;\n          case \"vw\":\n            textCSS +=  \"width:\" + (rect.width * 100/750).toFixed(6) + \"vw;<br>\";\n            break;\n          case \"rpx\":\n            textCSS +=  \"width:\" + rect.width  + \"rpx;<br>\";\n            break;\n          default:\n            log(\"无法识别这个单位\");\n            break;\n        }\n        switch(heightUnit){\n          case \"px@0.5x\":\n            textCSS +=  \"height:\" + (rect.height / 2) + \"px;<br>\";\n            break;\n          case \"px\":\n            textCSS +=  \"height:\" + rect.height  + \"px;<br>\";\n            break;\n          case \"vw\":\n            textCSS +=  \"height:\" + (rect.height * 100/750).toFixed(6) + \"vw;<br>\";\n            break;\n          case \"rpx\":\n            textCSS +=  \"height:\" + rect.height  + \"rpx;<br>\";\n            break;\n          default:\n            log(\"无法识别这个单位\");\n            break;\n        }\n        log('react style:' + textCSS);\n        return textCSS;\n    };\n////////////////////////////////////////////////////////////////////////////////\n//转换图层的位置单位\nconst convertPosition = function(rect1,rect2,settings){\n    let left = Math.round(rect1.x - rect2.x),\n        top = Math.round(rect1.y - rect2.y),\n        right = Math.round(rect1.maxX - rect2.maxX),\n        bottom = Math.round(rect1.maxY - rect2.maxY);\n    let textCSS = \"\";\n    let positionUnit = settings.position;\n        switch(positionUnit){\n          case \"px@0.5x\":\n            textCSS +=  \"left:\" + (left/2) + \"px;<br>\" + \"top:\" + (top/2)+ \"px;<br>\" + \"right:\" + (right/2)+ \"px;<br>\"+ \"bottom:\" + (bottom/2)+ \"px;<br>\";\n            break;\n          case \"px\":\n            textCSS +=  \"left:\" + left + \"px;<br>\" + \"top:\" + top+ \"px;<br>\" + \"right:\" + right+ \"px;<br>\"+ \"bottom:\" + bottom+ \"px;<br>\";\n            break;\n          case \"vw\":\n            textCSS = \"left:\" + (left * 100/750).toFixed(6) + \"vw;<br>\" + \"top:\" + (top * 100/750).toFixed(6)+ \"vw;<br>\" + \"right:\" + (right * 100/750).toFixed(6)+ \"vw;<br>\"+ \"bottom:\" + (bottom * 100/750).toFixed(6)+ \"vw;<br>\";\n            break;\n          case \"rpx\":\n            textCSS +=  \"left:\" + left + \"rpx;<br>\" + \"top:\" + top+ \"rpx;<br>\" + \"right:\" + right+ \"rpx;<br>\"+ \"bottom:\" + bottom+ \"rpx;<br>\";\n            break;\n          default:\n            log(\"无法识别这个单位\");\n            break;\n        }\n    return textCSS;\n}\n////////////////////////////////////////////////////////////////////////////////\n//获取text类型图层的样式\nconst getTextStyle = function(text,settings){\n    let textCSS = '';\n    //let attributes = text.attributedString().treeAsDictionary().value.attributes;\n    let fontSize = text.fontSize(),//获取font-size\n        lineHeight = text.lineHeight(),//获取line-height\n        textColor = text.textColor();//获取color\n    let fontSizeUnit = settings.fontSize,\n        lineHeightUnit = settings.lineHeight;\n    log('fontSize:' + fontSize);\n    log('lineHeight:' + lineHeight);\n    log('textColor:' + textColor);\n    \n        if(fontSize){\n          log('fontSizeUnit:' + fontSizeUnit);\n            switch(fontSizeUnit){\n              case \"px@0.5x\":\n                textCSS += \"font-size:\" + Math.round(fontSize/2) + \"px;<br>\";\n                break;\n              case \"px\":\n                textCSS += \"font-size:\" + Math.round(fontSize) + \"px;<br>\";\n                break;\n              case \"vw\":\n                textCSS += \"font-size:\" + (fontSize * 100/750).toFixed(6) + \"vw;<br>\";\n                break;\n              case \"rpx\":\n                textCSS += \"font-size:\" + Math.round(fontSize) + \"rpx;<br>\";\n                break;\n              default:\n                log(\"无法识别这个单位\");\n                break;\n            }\n        }\n        if(lineHeight){\n          log('lineHeightUnit:' + lineHeightUnit);\n          switch(lineHeightUnit){\n              case \"px@0.5x\":\n                textCSS += \"line-height:\" + Math.round(lineHeight/2) + \"px;<br>\";\n                break;\n              case \"px\":\n                textCSS += \"line-height:\" + Math.round(lineHeight) + \"px;<br>\";\n                break;\n              case \"vw\":\n                textCSS += \"line-height:\" + (lineHeight * 100/750).toFixed(6) + \"vw;<br>\";\n                break;\n              case \"rpx\":\n                textCSS += \"line-height:\" + Math.round(lineHeight) + \"rpx;<br>\";\n                break;\n              default:\n                log(\"无法识别这个单位\");\n                break;\n          }\n            \n        }\n    textCSS += \"color:\" + rgbaCode(textColor) +\";<br>\";\n    let shadow = topShadow(text.style());\n    let shadowUnit = settings.textShadow;\n    if (shadow) {\n    switch(shadowUnit){\n      case \"px@0.5x\":\n        textCSS += \"box-shadow:\" + rgbaCode(shadow.color())  + ' ' + Math.ceil(shadow.offsetX()/2) + \"px \" + Math.ceil(shadow.offsetY()/2) + \"px \" + Math.ceil(shadow.blurRadius()/2) + \"px;<br>\";\n      break;\n      case \"px\":\n        textCSS += \"box-shadow:\" + rgbaCode(shadow.color())  + ' ' + Math.ceil(shadow.offsetX()) + \"px \" + Math.ceil(shadow.offsetY()) + \"px \" + Math.ceil(shadow.blurRadius()) + \"px;<br>\";\n      break;\n      case \"vw\":\n        textCSS += \"box-shadow:\" + rgbaCode(shadow.color())  + ' ' + (shadow.offsetX() * 100/750).toFixed(6) + \"vw \" + (shadow.offsetY() * 100/750).toFixed(6) + \"vw \" + (shadow.blurRadius() * 100/750).toFixed(6) + \"vw;<br>\";\n      break;\n      case \"rpx\":\n        textCSS += \"box-shadow:\" + rgbaCode(shadow.color())  + ' ' + Math.ceil(shadow.offsetX()) + \"rpx \" + Math.ceil(shadow.offsetY()) + \"rpx \" + Math.ceil(shadow.blurRadius()) + \"rpx;<br>\";\n      break;\n        default:\n          log(\"无法识别这个单位\");\n        break;\n     }\n  }\n\n    return textCSS\n}\n////////////////////////////////////////////////////////////////////////////////\n//获取非文字图层的样式\nconst getLayerStyle = function(layer,settings) {\n\n  let textCSS = '';\n\n  let fill = topFill(layer.style());\n  log(fill.type);\n  if (fill.type == 0) {\n    textCSS += \"background-color:\" + rgbaCode(fill.bg.color()) + \";<br>\";\n  }else if(fill.type == 1){  \n    if(fill.bg.indexOf('deg') != -1){//判断是不是linear-gradient\n      log(fill.bg.indexOf('deg'));\n      textCSS += \"background-image:\" + \"linear-gradient(\" + fill.bg + \");<br>\";\n    }else{//判断是不是radial-gradient\n      textCSS += \"background-image:\" + \"radial-gradient(\" + fill.bg + \");<br>\";\n    }\n  }\n  //let borderRadius = layer.layers().firstObject().cornerRadiusFloat();\n  /*if (isCircle(layer)) {\n    textCSS += \"border-radius:\" + framerObject.width / 2 + \"px;<br>\";\n  } else {\n  if(borderRadius){\n    textCSS += \"border-radius:\" + Math.ceil(borderRadius/2) + \"px;<br>\";\n  }\n  */\n  let border = topBorder(layer.style());\n  let borderUnit = settings.border;\n  if (border) {\n    //log(\"borderColor:\" + border.color());\n    //log(\"borderRgbaColor:\" + rgbaCode(border.color()));\n    switch(borderUnit){\n              case \"px@0.5x\":\n                textCSS += \"border:\" + Math.ceil(border.thickness()/2) + \"px \" + \" solid \" + rgbaCode(border.color()) + \";<br>\";\n                break;\n              case \"px\":\n                textCSS += \"border:\" + Math.ceil(border.thickness()) + \"px \" + \" solid \" + rgbaCode(border.color()) + \";<br>\";\n                break;\n              case \"vw\":\n                textCSS += \"border:\" + (border.thickness() * 100/750).toFixed(6) + \"px \" + \" solid \" + rgbaCode(border.color()) + \";<br>\";\n                break;\n              case \"rpx\":\n                textCSS += \"border:\" + Math.ceil(border.thickness()) + \"rpx \" + \" solid \" + rgbaCode(border.color()) + \";<br>\";\n                break;\n              default:\n                log(\"无法识别这个单位\");\n                break;\n     }\n  }else{\n    log(\"没有border样式\");\n    log(\"border\" + border);\n  }\n\n  let shadow = topShadow(layer.style());\n  let shadowUnit = settings.boxShadow;\n  if (shadow) {\n    switch(shadowUnit){\n      case \"px@0.5x\":\n        textCSS += \"box-shadow:\" + rgbaCode(shadow.color())  + ' ' + Math.ceil(shadow.offsetX()/2) + \"px \" + Math.ceil(shadow.offsetY()/2) + \"px \" + Math.ceil(shadow.blurRadius()/2) + \"px;<br>\";\n      break;\n      case \"px\":\n        textCSS += \"box-shadow:\" + rgbaCode(shadow.color())  + ' ' + Math.ceil(shadow.offsetX()) + \"px \" + Math.ceil(shadow.offsetY()) + \"px \" + Math.ceil(shadow.blurRadius()) + \"px;<br>\";\n      break;\n      case \"vw\":\n        textCSS += \"box-shadow:\" + rgbaCode(shadow.color())  + ' ' + (shadow.offsetX() * 100/750).toFixed(6) + \"vw \" + (shadow.offsetY() * 100/750).toFixed(6) + \"vw \" + (shadow.blurRadius() * 100/750).toFixed(6) + \"vw;<br>\";\n      break;\n      case \"rpx\":\n        textCSS += \"box-shadow:\" + rgbaCode(shadow.color())  + ' ' + Math.ceil(shadow.offsetX()) + \"rpx \" + Math.ceil(shadow.offsetY()) + \"rpx \" + Math.ceil(shadow.blurRadius()) + \"rpx;<br>\";\n      break;\n        default:\n          log(\"无法识别这个单位\");\n        break;\n     }\n  }\n\n  let opacity = layer.style().contextSettings().opacity();\n  if (opacity != 1) {\n    textCSS += \"opacity:\" + opacity + \";<br>\";\n  }\n\n  return textCSS;\n}\n////////////////////////////////////////////////////////////////////////////////\n//颜色转为rgba形式\nconst rgbaCode = function(colour) {\n  let red = Math.round(colour.red() * 255);\n  let green = Math.round(colour.green() * 255);\n  let blue = Math.round(colour.blue() * 255);\n\n  return 'rgba(' + red + ',' + green + ',' + blue + ',' + colour.alpha().toFixed(2) + ')';\n}\n////////////////////////////////////////////////////////////////////////////////\n//获取填充的颜色、渐变\nconst topFill = function(style) {\n  var fills = style.enabledFills(),\n      fill = {\n        type: null,\n        bg: null\n      };\n\n  var i, len = null;\n  for (i = 0, len = fills.length; i < len; i++) {\n    var fillType = fills[i].fillType();\n    log(fillType);\n    if (fillType == 0) {\n      fill.bg = fills[i];\n      log('fillBg:' + fill.bg);\n      log('filleType:' + fill.type);\n    }else{\n      fill.type = fillType;\n      fill.bg = fills[i].gradient().gradientStringWithMasterAlpha(5);\n      log('fillBg:' + fill.bg);\n      log('filleType:' + fill.type);\n    }\n\n  }\n\n  return fill;\n}\n////////////////////////////////////////////////////////////////////////////////\n//获取border样式\nconst  topBorder = function(style) {\n  var borders = style.enabledBorders();\n\n  var i, len, border = null;\n  for (i = 0, len = borders.length; i < len; i++) {\n    var fillType = borders[i].fillType();\n    if (fillType == 0) {\n      border = borders[i];\n    }\n  }\n\n  return border;\n}\n////////////////////////////////////////////////////////////////////////////////\n//获取shadow样式\nconst topShadow = function(style) {\n  let shadows = style.enabledShadows();\n  let len = shadows.length;\n\n  if (len == 0) {\n    return null;\n  } else {\n    return shadows[len - 1];\n  }\n}\n////////////////////////////////////////////////////////////////////////////////\nexport function getStyle(selection){\n  let style = '';\n  //let sketchObject = selection.sketchObject;\n  let layerCount = selection.count();\n  log(layerCount);\n\n  if( !(layerCount > 0 && layerCount < 3) ){\n    log(\"Select 1 or 2 layers to get style!\");\n            style = \"Select 1 or 2 layers to get style!\"\n            return style;\n }else if(layerCount == 1){\n            let settings = getSettings();\n            log(\"Select 1!\");\n            log(settings);\n            let targetRect = getRect(selection[0]);\n            //转换宽高单位\n            style = convertUnit(targetRect,settings);\n            let layerClass = selection[0].class();\n            //判断是否为group\n            if((layerClass == MSShapeGroup) || (layerClass == MSRectangleShape)){\n              log('is group or rectangle');\n              style += getLayerStyle(selection[0],settings);\n            }\n            else if(layerClass == MSTextLayer){\n              //判断是否为text\n              log('is text');\n              style += getTextStyle(selection[0],settings);\n            }else{\n              log(layerClass);\n            }\n                    //log(selection[0].CSSAttributes());\n            return style;\n        }else if(layerCount == 2){\n\n           let target = (selection.count() == 1)? selection[0]: selection[1],\n                layer = (selection.count() == 1)? this.current: selection[0];\n            let targetRect = getRect(target),\n                layerRect = getRect(layer);\n            style = convertPosition(targetRect,layerRect,settings);\n            log(style);\n            \n            return style;\n        }\n}","/*获取设置*/\nimport sketch from 'sketch';//引入sketch 的新API（新旧混用，心情复杂\n\nexport function getSettings(){\n  let Settings = sketch.Settings;//引入sketch 的Settings API\n  let settings = { //初始化settings\n    width: 'vw',\n    height: 'vw',\n    fontSize: 'px',\n    lineHeight: 'px',\n    border: 'px',\n    boxShadow: 'px',\n    textShadow: 'px',\n    position: 'vw'\n  };\n\n  Object.keys(settings).forEach(function(key){\n    let value = settings[key],\n        unit = Settings.settingForKey(key);\n    if(unit !== value){\n      //判断是否已重新设置单位，如有则更新settings\n      settings[key] = unit;\n      log(key + ':' + unit);\n    }else{\n      //未重新设置，则保持默认的\n      log(key + \"未重新设置\");\n    }\n     \n\n  });\n\n  return settings;\n\n}\n","module.exports = require(\"sketch\");"],"sourceRoot":""}